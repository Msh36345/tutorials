# ğŸ¨ Polars Testing & Debugging - Visual Cheat Sheet

<div dir="rtl">

## ğŸ” × ×™×¤×•×™ ×©×’×™××•×ª - Decision Tree

```
×™×© ×œ×š ×©×’×™××”?
â”‚
â”œâ”€â†’ ×©×’×™××” ×‘×©×¨×©×¨×ª ××¨×•×›×”?
â”‚   â”‚
â”‚   â”œâ”€â†’ ××•×¤×¦×™×” 1: ×”×¢×¨ ×©×•×¨×•×ª (Commenting) âš¡ ××”×™×¨
â”‚   â”‚   â””â”€â†’ ×”×¡×¨ ×©×œ×‘×™× ×¢×“ ×©×”×§×•×“ ×¢×•×‘×“
â”‚   â”‚
â”‚   â”œâ”€â†’ ××•×¤×¦×™×” 2: Eager Mode ğŸŒ ××™×˜×™ ××‘×œ ××“×•×™×§
â”‚   â”‚   â””â”€â†’ ×”×•×¡×£ collect() ××•×§×“×
â”‚   â”‚
â”‚   â””â”€â†’ ××•×¤×¦×™×” 3: pipe() â­ ××•××œ×¥!
â”‚       â””â”€â†’ ×¤×¦×œ ×œ×¤×•× ×§×¦×™×•×ª + ×‘×“×•×§ ×›×œ ××—×ª
â”‚
â””â”€â†’ ×©×’×™××” ×‘×œ×™ ×©×¨×©×¨×ª?
    â””â”€â†’ ×‘×“×•×§: schema, dtypes, null_count()
```

---

## âš¡ ××•×¤×˜×™××™×–×¦×™×” - Flow Chart

```
×”×ª×—×œ×”
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. filter()     â”‚ â† ×¡× ×Ÿ ××•×§×“× ×›×›×œ ×”××¤×©×¨
â”‚  ××¦××¦× ×©×•×¨×•×ª    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. select()     â”‚ â† ×‘×—×¨ ×¨×§ ×¢××•×“×•×ª × ×—×•×¦×•×ª
â”‚  ××¦××¦× ×¢××•×“×•×ª   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. with_columns â”‚ â† ×”×•×¡×£ ×¢××•×“×•×ª ×—×™×©×•×‘×™×•×ª
â”‚  ×—×™×©×•×‘×™×        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. sort/join    â”‚ â† ×¤×¢×•×œ×•×ª ×›×‘×“×•×ª ×‘×¡×•×£
â”‚  ×¤×¢×•×œ×•×ª ××•×¨×›×‘×•×ª  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
     collect()
```

---

## ğŸ“Š cuallee - Validation Matrix

| ×¡×•×’ ×‘×“×™×§×” | ××ª×™ ×œ×”×©×ª××© | ×¤×§×•×“×” | ×“×•×’××” |
|-----------|-----------|-------|--------|
| **ğŸ¯ ×©×œ××•×ª** | ××™×Ÿ nulls | `.is_complete()` | ×©×“×” ×©× ×—×•×‘×” |
| **ğŸ”¢ ×™×™×—×•×“×™×•×ª** | ××™×Ÿ ×›×¤×™×œ×•×™×•×ª | `.is_unique()` | ××–×”×” ×™×™×—×•×“×™ |
| **ğŸ“‹ ×¢×¨×›×™× ××§×•×‘×œ×™×** | ×¨×©×™××” ×¡×’×•×¨×” | `.is_contained_in()` | ×§×˜×’×•×¨×™×•×ª |
| **ğŸ“ˆ ×˜×•×•×—** | min-max | `.is_between()` | ×’×™×œ 0-120 |
| **â• ×—×™×•×‘×™** | > 0 | `.is_greater_than()` | ××—×™×¨ |
| **â– ×©×œ×™×œ×™** | < 0 | `.is_less_than()` | ×—×•×‘ |
| **ğŸ”— ×§×©×¨** | ×¢××•×“×•×ª ×ª×œ×•×™×•×ª | `.satisfies()` | start < end |

---

## ğŸ¯ Pattern: ×”×§×•×“ ×”××•×©×œ×

```python
# âœ… ×“×•×’××” ×œ××‘× ×” ××•××œ×¥

import polars as pl
from cuallee import Check, CheckLevel

# 1ï¸âƒ£ ×˜×¢×™× ×” (Lazy)
lf = pl.scan_csv('data.csv')

# 2ï¸âƒ£ ×¤×•× ×§×¦×™×•×ª ××•×“×•×œ×¨×™×•×ª
def validate_input(lf):
    """×‘×“×™×§×•×ª ×§×œ×˜"""
    return lf.filter(pl.col('value').is_not_null())

def clean_data(lf):
    """× ×™×§×•×™"""
    return lf.with_columns(
        pl.col('name').str.to_lowercase()
    )

def transform(lf):
    """×˜×¨× ×¡×¤×•×¨××¦×™×”"""
    return lf.with_columns(
        ratio=pl.col('a') / pl.col('b')
    )

# 3ï¸âƒ£ Pipeline
result = (
    lf
    .pipe(validate_input)
    .pipe(clean_data)
    .pipe(transform)
    .collect()
)

# 4ï¸âƒ£ ×‘×“×™×§×•×ª ××™×›×•×ª
check = Check(CheckLevel.WARNING, 'Final QA')
(
    check
    .is_complete('name')
    .is_greater_than('ratio', 0)
    .validate(result)
)
```

---

## ğŸš¦ Traffic Light System - ××ª×™ ×œ×”×©×ª××© ×‘××”?

### ğŸŸ¢ ×ª××™×“ ×¢×©×•

| ×¤×¢×•×œ×” | ×œ××” |
|-------|-----|
| `scan_csv()` ×‘××§×•× `read_csv()` | ××•×¤×˜×™××™×–×¦×™×” ××•×˜×•××˜×™×ª |
| `filter()` ××•×§×“× | ×¤×—×•×ª × ×ª×•× ×™× ×œ×¢×‘×“ |
| `select()` ××•×§×“× | ×¤×—×•×ª ×¢××•×“×•×ª ×œ×˜×¢×•×Ÿ |
| `pipe()` ×œ××¨×’×•×Ÿ | ×§×•×“ × ×§×™ ×•×‘×¨×•×¨ |
| `explain()` ×œ×‘×“×™×§×” | ×”×‘× ×ª ×”××•×¤×˜×™××™×–×¦×™×•×ª |

### ğŸŸ¡ ×¢×©×• ×‘×–×”×™×¨×•×ª

| ×¤×¢×•×œ×” | ××ª×™ |
|-------|-----|
| `collect()` ×‘×××¦×¢ | ×¨×§ ×œ×“×™×‘××’ |
| `join()` ××•×¨×›×‘ | ×ª×›× × ×• ××¨××© |
| `window()` | ×‘×“×§×• ×‘×™×¦×•×¢×™× |
| Streaming | ×§×‘×¦×™× ×’×“×•×œ×™× ×××•×“ |

### ğŸ”´ ××œ ×ª×¢×©×•

| ×¤×¢×•×œ×” | ×œ××” |
|-------|-----|
| `collect()` ××™×•×ª×¨ | ×‘×–×‘×•×– ×–×™×›×¨×•×Ÿ |
| ×©×¨×©×¨×ª ××¨×•×›×” ×‘×œ×™ `pipe()` | ×§×©×” ×œ×“×‘×’ |
| ××™×Ÿ ×‘×“×™×§×•×ª ××™×›×•×ª | ×‘××’×™× ×‘×”××©×š |
| ×¡×™× ×•×Ÿ ×××•×—×¨ | ×‘×–×‘×•×– ×—×™×©×•×‘×™× |

---

## ğŸ¨ ×•×™×–×•××œ×™×–×¦×™×”: Query Plan

### ×œ×¤× ×™ ××•×¤×˜×™××™×–×¦×™×”:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CSV Scan    â”‚ â† ×§×•×¨× ×”×›×œ
â”‚ (All Cols)  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ with_columnsâ”‚ â† ××—×©×‘ ×¢×œ ×”×›×œ
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ filter      â”‚ â† ××¡× ×Ÿ ×××•×—×¨
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ select      â”‚ â† ×–×•×¨×§ ×¢××•×“×•×ª
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â†“
    Output
    
ğŸ’¾ ×–×™×›×¨×•×Ÿ: ×’×‘×•×”
â±ï¸ ×–××Ÿ: ××™×˜×™
```

### ××—×¨×™ ××•×¤×˜×™××™×–×¦×™×”:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CSV Scan    â”‚ â† ×¨×§ ×¢××•×“×•×ª × ×—×•×¦×•×ª
â”‚ (Select)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ filter      â”‚ â† ××¡× ×Ÿ ××•×§×“×
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ with_columnsâ”‚ â† ××—×©×‘ ×¨×§ ×¢×œ ××¡×•× × ×™×
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â†“
    Output
    
ğŸ’¾ ×–×™×›×¨×•×Ÿ: × ××•×š
â±ï¸ ×–××Ÿ: ××”×™×¨
```

---

## ğŸ”§ ×˜×‘×œ×ª ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª

| ğŸš¨ ×¡×™××¤×˜×•× | ğŸ” ××‘×—×•×Ÿ | ğŸ’Š ×¤×ª×¨×•×Ÿ |
|-----------|---------|---------|
| **×§×•×“ ××™×˜×™** | `explain()` | ×”×¢×‘×¨ `filter()` ×§×“×™××” |
| **×©×’×™××ª ×¢××•×“×”** | `lf.schema` | ×‘×“×•×§ ×©××•×ª |
| **×–×™×›×¨×•×Ÿ ××œ×** | | Streaming ××• `collect()` ×××•×—×¨ |
| **×ª×•×¦××” ×œ× × ×›×•× ×”** | ×”×“×¤×¡ ×‘×™× ×™×™× | `pipe()` + ×‘×“×™×§×•×ª |
| **×©×’×™××ª ×˜×™×¤×•×¡** | `lf.dtypes` | `cast()` |
| **nulls ×œ× ×¦×¤×•×™×™×** | `null_count()` | `fill_null()` ××• `drop_nulls()` |

---

## ğŸ“ × ×•×¡×—××•×ª ××”×™×¨×•×ª

### ×‘×™×¦×•×¢×™×:
```
×–××Ÿ ×‘×™×¦×•×¢ â‰ˆ (××¡×¤×¨ ×©×•×¨×•×ª Ã— ××¡×¤×¨ ×¢××•×“×•×ª Ã— ××•×¨×›×‘×•×ª ×¤×¢×•×œ×•×ª)

××•×¤×˜×™××™×–×¦×™×” = ×¡×™× ×•×Ÿ ××•×§×“× + ×‘×—×™×¨×ª ×¢××•×“×•×ª + Lazy mode
```

### ××™×›×•×ª ×§×•×“:
```
×§×¨×™××•×ª = ××¡×¤×¨ ×©×•×¨×•×ª ×‘×¤×•× ×§×¦×™×” < 20
×ª×—×–×•×§×” = ×›×œ ×¤×•× ×§×¦×™×” ×¢×•×©×” ×“×‘×¨ ××—×“
×‘×“×™×§×•×ª = ×œ×¤×—×•×ª 1 test ×œ×›×œ ×¤×•× ×§×¦×™×”
```

---

## ğŸ¯ Keyboard Shortcuts (×× ×˜×œ×™)

| ×¨×•×¦×” ×œ... | ×—×©×•×‘ ×¢×œ... | ×§×•×“ |
|-----------|-----------|-----|
| **×¡× ×Ÿ ×©×•×¨×•×ª** | `WHERE` ×‘-SQL | `.filter()` |
| **×‘×—×¨ ×¢××•×“×•×ª** | `SELECT` ×‘-SQL | `.select()` |
| **×”×•×¡×£ ×¢××•×“×”** | `Computed field` | `.with_columns()` |
| **××™×™×Ÿ** | `ORDER BY` | `.sort()` |
| **×§×‘×¥** | `GROUP BY` | `.group_by()` |
| **×¦×¨×£ ×˜×‘×œ××•×ª** | `JOIN` | `.join()` |

---

## ğŸ“Š Complexity Scale

```
×¤×©×•×˜                                    ××•×¨×›×‘
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤
â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
filter  select  sort  with_columns  join  window  pivot
â”‚                     â”‚                   â”‚
â””â”€ ×–×•×œ              â””â”€ ×‘×™× ×•× ×™         â””â”€ ×™×§×¨
   (××”×™×¨)              (×ª×œ×•×™)            (××™×˜×™)
```

---

## ğŸ¨ Color Coding ×œ××¡×§× ×•×ª

### ğŸŸ¢ ××” ×¢×•×‘×“ ×˜×•×‘?
- âœ… Lazy mode ×¢× ××•×¤×˜×™××™×–×¦×™×”
- âœ… ×¡×™× ×•×Ÿ ××•×§×“×
- âœ… pipe() ×œ××¨×’×•×Ÿ
- âœ… ×‘×“×™×§×•×ª cuallee

### ğŸŸ¡ ××” ×“×•×¨×© ×ª×©×•××ª ×œ×‘?
- âš ï¸ Join ×¢×œ datasets ×’×“×•×œ×™×
- âš ï¸ Window functions ××•×¨×›×‘×•×ª
- âš ï¸ Regex ×¢×œ ×˜×§×¡×˜ ××¨×•×š
- âš ï¸ Group by ×¢× aggregations ×›×‘×“×•×ª

### ğŸ”´ ××” ×œ×”×™×× ×¢ ××× ×•?
- âŒ collect() ×œ× ××ª×•×›× ×Ÿ
- âŒ ×©×¨×©×¨××•×ª ××¨×•×›×•×ª ×œ×œ× ××‘× ×”
- âŒ ××™×Ÿ ×˜×™×¤×•×œ ×‘×©×’×™××•×ª
- âŒ ××™×Ÿ ×‘×“×™×§×•×ª ××™×›×•×ª

---

## ğŸ§ª Testing Pyramid

```
           /\
          /  \
         /    \
        / UI   \      â† ×¤×—×•×ª (End-to-End)
       /â”€â”€â”€â”€â”€â”€â”€â”€\
      /          \
     / Integration\   â† ×‘×™× ×•× ×™
    /â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\
   /                \
  /   Unit Tests     \ â† ×”×›×™ ×”×¨×‘×”!
 /â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\

×‘×¤×¨×•×™×§×˜ Polars:
- Unit: ×›×œ pipe() function
- Integration: pipeline ××œ×
- E2E: cuallee validations
```

---

## ğŸ“ Learning Path

```
ğŸ“š ××ª×—×™×œ
   â”œâ”€ basics ×©×œ Polars
   â”œâ”€ filter, select, sort
   â””â”€ read_csv, write_csv
   
ğŸ“š ×‘×™× ×™×™×
   â”œâ”€ LazyFrame vs DataFrame
   â”œâ”€ with_columns
   â”œâ”€ pipe() ×œ××¨×’×•×Ÿ
   â””â”€ explain() ×‘×¡×™×¡×™
   
ğŸ“š ××ª×§×“×
   â”œâ”€ Query optimization
   â”œâ”€ Streaming mode
   â”œâ”€ Custom functions
   â””â”€ cuallee validations
   
ğŸ“š ××•××—×”
   â”œâ”€ Performance tuning
   â”œâ”€ Complex joins
   â”œâ”€ Custom aggregations
   â””â”€ Production pipelines
```

---

## ğŸ”„ ×”×“×¤×¡×” ×œ×©×™××•×© ×™×•××™×•××™

### Quick Commands
```bash
# ×‘×“×™×§×ª schema
lf.schema
lf.collect_schema()

# ×‘×“×™×§×ª nulls
lf.null_count().collect()

# ×‘×“×™×§×ª shape
lf.select(pl.count()).collect()

# ×”×“×¤×¡×ª plan
print(lf.explain())

# 5 ×¨××©×•× ×™×
lf.head().collect()

# ×¡×¤×™×¨×ª ×¢×¨×›×™× ×™×™×—×•×“×™×™×
lf.select('col').unique().count().collect()
```

### Debug Template
```python
# ×”×•×¡×£ ×‘×›×œ ×¤×•× ×§×¦×™×”
def my_function(lf):
    print(f"Shape: {lf.select(pl.count()).collect()}")
    print(f"Columns: {lf.columns}")
    return lf.with_columns(...)
```

---

## ğŸ’¡ Pro Tips

### ğŸ¯ ×˜×™×¤ #1: Schema First
```python
# ×ª××™×“ ×‘×“×•×§ schema ×œ×¤× ×™ ×”×ª×—×œ×”
print(lf.schema)
```

### ğŸ¯ ×˜×™×¤ #2: Small Data Debug
```python
# ×“×‘×’ ×¢×œ ×“×’×™××” ×§×˜× ×”
lf_sample = lf.head(100)
```

### ğŸ¯ ×˜×™×¤ #3: Explain Everything
```python
# ×ª××™×“ ×‘×“×•×§ ××ª ×”-plan
print(lf.explain())
```

### ğŸ¯ ×˜×™×¤ #4: Test Early
```python
# ×‘×“×™×§×•×ª ××™×“ ××—×¨×™ ×”×˜×¢×™× ×”
check.is_complete('id').validate(df)
```

### ğŸ¯ ×˜×™×¤ #5: Document Functions
```python
def process(lf: pl.LazyFrame) -> pl.LazyFrame:
    """×ª×™×¢×•×“ ×‘×¨×•×¨ ×©×œ ××” ×”×¤×•× ×§×¦×™×” ×¢×•×©×”"""
    return lf.with_columns(...)
```

---

## ğŸ Bonus: One-Liners

```python
# ×¡×¤×™×¨×” ××”×™×¨×”
lf.select(pl.count()).collect()[0,0]

# ×›×œ ×”×¢×¨×›×™× ×”×™×™×—×•×“×™×™×
lf.select('col').unique().collect()['col'].to_list()

# ×‘×“×™×§×ª duplicates
df.is_duplicated().any()

# drop nulls ×‘×›×œ ×”×¢××•×“×•×ª
lf.drop_nulls()

# ×¡×˜×˜×™×¡×˜×™×§×•×ª ××”×™×¨×•×ª
df.describe()

# ×‘×“×™×§×ª ×–×™×›×¨×•×Ÿ
df.estimated_size()
```

---

## ğŸ“ Checklist ×œ×¤× ×™ Production

- [ ] ×›×œ ×”×¤×•× ×§×¦×™×•×ª ××ª×•×¢×“×•×ª
- [ ] ×™×© ×‘×“×™×§×•×ª cuallee
- [ ] ×”×§×•×“ ××©×ª××© ×‘-pipe()
- [ ] ×‘×“×§×ª×™ ××ª explain()
- [ ] ××™×Ÿ collect() ××™×•×ª×¨
- [ ] ×™×© ×˜×™×¤×•×œ ×‘×©×’×™××•×ª
- [ ] ×”×§×•×“ × ×‘×“×§ ×¢× × ×ª×•× ×™× ×××™×ª×™×™×
- [ ] ×™×© unit tests
- [ ] performance ××§×•×‘×œ
- [ ] ×”×§×•×“ ×‘-version control

---

## ğŸŒŸ Remember

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  "Premature optimization is the     â”‚
â”‚   root of all evil"                  â”‚
â”‚                                      â”‚
â”‚  BUT!                                â”‚
â”‚                                      â”‚
â”‚  "Polars does optimization for you"  â”‚
â”‚                                      â”‚
â”‚  â†’ Use Lazy mode                     â”‚
â”‚  â†’ Filter early                      â”‚
â”‚  â†’ Let Polars optimize               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**×‘×”×¦×œ×—×”! ğŸš€**

*××•××œ×¥ ×œ×”×“×¤×™×¡ ×•×œ×ª×œ×•×ª ×œ×™×“ ×”××—×©×‘* ğŸ“„

</div>
